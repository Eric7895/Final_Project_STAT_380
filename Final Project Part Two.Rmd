---
title: "Final Project: Report 2"
author: "Eric Wu"
date: "`r Sys.Date()`"
output: html_document
editor_options: 
  markdown: 
    wrap: sentence
---

## Introduction

We decided to use the "House Rent Prediction" (HRP) dataset found on Kaggle, a data science community known for its enriched various data sources.
The HRP dataset consists of 4700+ observations and 11 attributes that allow us to make a prediction on the number of rents given a variety of attributes.

Here's the list of variables used and explained by the contributor of the dataset:

-   BHK: Number of Bedrooms, Hall, Kitchen

-   Rent: Rent of the Houses/Apartments/Flats

-   Size: Size of the Houses/Apartments/Flats in Square Feet

-   Floor: Houses/Apartments/Flats situated on which Floor and Total Number of Floors (Example: Ground out of 2, 3 out of 5, etc.)

-   Area Type: Size of the Houses/Apartments/Flats calculated on either Super Area or Carpet Area or Build Area.

-   Area Locality (Area.Locality): Locality of the Houses/Apartments/Flats

-   City: City where the Houses/Apartments/Flats are Located

-   Furnishing Status: Furnishing Status of the Houses/Apartments/Flats, either it is Furnished or Semi-Furnished or Unfurnished

-   Tenant Preferred: Type of Tenant Preferred by the Owner or Agent

-   Bathroom: Number of Bathrooms

-   Point of Contact (Posted.On): Whom should you contact for more information regarding the Houses/Apartments/Flats

```{r libraries and dataset}
#| echo = FALSE,
#| warning = FALSE,
#| message = FALSE

# Load essential libraries
library(tidyverse)
library(ggplot2)
library(keras)
library(ISLR2)

# Load the dataset
hrp <- read.csv("House_Rent_Dataset.csv")
```

```{r parameters and set ups}
#| echo = FALSE

# Set up all parameters
seed <- 123

# Set up the necessary matrix
x <- scale(model.matrix(Rent ~ . - 1, data = hrp)) # Create an scale a model matrix that's similar to linear model. 
y <- hrp$Rent

# Set up the training/testing split
set.seed(seed)
train_ind <- sample(1:nrow(hrp), floor(0.8 * nrow(hrp)))
set.seed(NULL)

train = hrp[train_ind, ]
test = hrp[-train_ind, ]
```

## Exploratory Data Analysis

### Data Visualization

### Hierarchical clustering

## Methodology

Our plan is to compare and contrast a multiple regression model, a KNN regression model, and a single-layer neural network in predicting the rent based using other predictors in the dataset.
All models will involve some sort of variable selection, whether it's using other functions or included in model building, this is very beneficial when we are doing model selections.
The primary focus is to compare the RMSE produced by each model.

### Multiple Linear Regression

### KNN Regression

### Single-Layer Neural Network
```{r single layer neural network}
modnn <- keras_model_sequential() %>%
     layer_dense(units = 2351, activation = "relu", 
        input_shape = ncol(x)) %>% # Create a hidden layer with 2351 hidden units and a ReLU activation function
     layer_dropout(rate = 0.4) %>% # Create a dropout layer in which a random 40% of the 50 activation from the previous layer are set to zero during each iteration of stochastic gradiant descent algorithm (An optimization algorithm often used to find the model parameter that correspond to the best fit between predicted and actual outputs)
     layer_dense(units = 1) # The output layer has just one unit with no activation function, indicating that the model provides a single quantitative output.

modnn %>% compile(loss = "mse", # This adds details to the fitting algorithm that minimize the squared-error loss as it tracks the mean absolute error on the training data, and on the testing data if it is supplied. 
    optimizer = optimizer_rmsprop(),
    metrics = list("mean_square_error")
   )

# Now we are actually fitting the model 
history <- modnn %>% fit(
     train, test, epochs = 600, batch_size = 32,
    validation_data = list(train, test)
  )

npred <- predict(modnn, test)

```

## Discussion

## Conclusion
